---
import { getLocale } from "astro-i18n-aut";

const locale = getLocale(Astro.url);
---
client:load

<div class="footer-controls">
	<div class="language-switcher">
		<button onclick="switchLanguage('es')" class={`lang-btn ${locale === 'es' ? 'active' : ''}`}>ES</button>
		<span>|</span>
		<button onclick="switchLanguage('en')" class={`lang-btn ${locale === 'en' ? 'active' : ''}`}>EN</button>
	</div>
	<div class="theme-switcher">
		<button class="theme-toggle" id="theme-toggle">üåô</button>
	</div>
</div>

<script>
	function switchLanguage(lang: string) {
		const currentPath = window.location.pathname;
		const newPath = lang === 'es' ? currentPath.replace(/^\/en/, '') || '/' : `/en${currentPath}`;
		window.location.href = newPath;
	}

	function toggleTheme() {
		const html = document.documentElement;
		const currentTheme = html.getAttribute('data-theme');
		const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
		html.setAttribute('data-theme', newTheme);
		localStorage.setItem('theme', newTheme);

		// Update button icon
		const themeBtn = document.getElementById('theme-toggle') as HTMLButtonElement;
		if (themeBtn) {
			themeBtn.textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
		}
	}

	// Initialize theme
	document.addEventListener('DOMContentLoaded', function() {
		const savedTheme = localStorage.getItem('theme') || 'light';
		document.documentElement.setAttribute('data-theme', savedTheme);
		const themeBtn = document.getElementById('theme-toggle') as HTMLButtonElement;
		if (themeBtn) {
			themeBtn.textContent = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
			themeBtn.addEventListener('click', toggleTheme);
		}
	});
</script>

<style>
	.footer-controls {
		display: flex;
		gap: 1rem;
		align-items: center;
	}

	.language-switcher {
		display: flex;
		gap: 0.5rem;
		align-items: center;
	}

	.lang-btn {
		background: transparent;
		border: 1px solid var(--accent-color);
		color: var(--accent-color);
		padding: 0.5rem 1rem;
		border-radius: 20px;
		cursor: pointer;
		font-weight: 500;
		transition: all 0.3s;
	}

	.lang-btn:hover {
		background: var(--accent-color);
		color: white;
	}

	.lang-btn.active {
		background: var(--accent-color);
		color: white;
	}

	.theme-switcher {
		display: flex;
		gap: 0.5rem;
		align-items: center;
		margin-left: 1rem;
	}

	.theme-toggle {
		background: transparent;
		border: 1px solid var(--accent-color);
		color: var(--accent-color);
		padding: 0.5rem 1rem;
		border-radius: 20px;
		cursor: pointer;
		font-weight: 500;
		transition: all 0.3s;
	}

	.theme-toggle:hover {
		background: var(--accent-color);
		color: white;
	}

	/* Responsive */
	@media (max-width: 768px) {
		.footer-controls {
			flex-direction: column;
			gap: 0.5rem;
		}

		.language-switcher {
			justify-content: center;
		}

		.theme-switcher {
			margin-left: 0;
		}
	}
</style>
